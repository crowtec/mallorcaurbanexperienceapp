import Z from"./LocationFound.159b420e.js";import Q from"./Logo.8252163e.js";import ee from"./Radar.c41f152b.js";import te from"./CompassCardinalPoints.d39a5868.js";import oe from"./Compass.1403b4cd.js";import ae from"./Button.409fc7c7.js";import se from"./Intersect.8b1b1e76.js";import ne from"./Search.9e47e3c1.js";import le from"./Menu.437df467.js";import ce from"./NavigationBar.59a481ef.js";import re from"./Menu.8ba515b0.js";import{k as ie,bI as ue,c3 as me,p as de,y as _e,r as s,j as fe,g as pe,m as ve,c as _,b as o,w as u,bE as M,a as f,u as e,q as h,F as he,bZ as ye,o as r,x as we,n as ge,i as T,bG as Ce,bH as xe,bJ as S}from"./entry.df04a53e.js";import{q as ke}from"./query.9e058201.js";import{u as be}from"./map.d7167cab.js";import{d as Re}from"./timer.1612f152.js";import{u as Be}from"./locations.68f83c9f.js";import{g as Ie}from"./index.4db78ffb.js";import{P as Le,L as $}from"./permission.6b6370dd.js";import{a as Me}from"./index.876757e2.js";import"./Diamond.b48a9fae.js";import"./BlurredCircle.2818db1f.js";import"./tw-merge.1166cefb.js";import"./nuxt-link.c0932417.js";import"./SectionHeading.23e742fe.js";import"./Cross.29bba4db.js";import"./utils.0c08eecf.js";import"./preview.ad706769.js";const E=y=>(Ce("data-v-66640ac4"),y=y(),xe(),y),Se={key:0},$e={class:"relative"},Ne={key:0,class:"fixed h-full w-full top-0 left-0 radar-background"},qe=E(()=>f("div",{class:"fixed w-full top-0 h-[20vh] bg-gradient-to-b from-sky-900 to-70%"},null,-1)),Fe={key:0,class:"fixed left-0 top-0 translate-y-[-180%] container text-center"},Pe=E(()=>f("div",{class:"text-md text-yellow-200"}," ¡Vaya! Parece que aquí no hay nada ",-1)),Te=[Pe],Ee={key:0},Ve={__name:"map",async setup(y){let w,N;const q=ue(),{data:k}=([w,N]=me(()=>ye("locations",()=>ke("location").find(),{transform:t=>Object.keys(t).map(d=>t[d])})),w=await w,N(),w),l=be(),V=de(),F=_e();s(null);const g=s(null),m=s(null),b=s(null),C=s(null),R=s(null),c=s(),x=s(!1),a=s(),p=s(),P=s(),j=s(0),B=s(!1),{width:I,height:je}=Me(),A=()=>{const t=C.value.getBoundingClientRect(),d=t.top+t.height/2;t.left+t.width/2;const i=g.value.getBoundingClientRect();g.value.style.top=`${d-i.height/2}px`},D=t=>{B.value||(B.value=!0,l.value.toggleCenitalView({onComplete:()=>{B.value=!1}}))},z=async()=>{const t=Ie.timeline();P.value=await Le.requestLocation(),P.value?(c.value=!0,t.add("start").to(b.value,{x:-I.value},"start").to(R.value,{x:I.value},"start"),Promise.all([$.getCurrentLocation(),Re(4e3)]).then(([d])=>{let i;for(let n=0;n<k.value.length;n++){const v=$.calculateDistanceBetweenCoordinates(d,k.value[n].place.coordinate);v<$.NEARBY_DISTANCE_IN_KM&&(!i||v<i)&&(i=v,a.value=k.value[n])}if(c.value=!1,p.value=!0,a.value?(m.value.show({expanded:!1}),t.to(C.value,{y:I.value*.5})):t.add("start").to(b.value,{x:0},"start").to(R.value,{x:0},"start"),a.value){const n=Be();n.value.includes(a.value._id)||n.value.push(a.value._id),setTimeout(()=>{F.push({path:`${a.value._path}/model`})},5e3)}else setTimeout(()=>{p.value=!1},2e3)})):F.push({path:"/permissions"})},U=t=>{l.value.hide(),m.value.hide(),x.value=!0},H=t=>{setTimeout(()=>{l.value.show()},300),m.value.show({expanded:!0,onComplete:()=>{x.value=!1}})};return fe(()=>{C.value&&g.value&&A(),x.value||c.value||p.value?q.value=S.sky[900]:q.value=V.value?S.teal[700]:S.teal[500]}),pe(()=>{m.value&&m.value.show({expanded:!0}),l.value&&(l.value.show(),l.value.showLocations())}),ve(()=>{l.value&&l.value.hideLocations()}),(t,d)=>{const i=Z,n=Q,v=ee,W=te,G=oe,L=ae,J=se,K=ne,O=le,X=ce,Y=re;return r(),_(he,null,[o(M,{name:"fade",appear:""},{default:u(()=>[e(a)?(r(),_("div",Se,[o(i,{location:e(a)},null,8,["location"])])):h("",!0)]),_:1}),f("div",$e,[o(n,{"enable-night-mode-change":""}),o(M,{name:"fade",appear:""},{default:u(()=>[e(c)||e(p)&&!e(a)?(r(),_("div",Ne)):h("",!0)]),_:1}),e(c)?(r(),_("div",{key:0,ref_key:"radarRef",ref:g,class:"fixed top-0 left-0 w-screen h-screen"},[o(v),qe],512)):h("",!0),o(X,{ref_key:"navRef",ref:m,"inital-state":"hide",centered:""},{default:u(()=>[f("div",{ref_key:"compassButtonRef",ref:b},[o(L,{onClick:D,class:"bg-yellow-200 h-16 w-16 relative flex justify-center items-center",format:"circle",shadowed:""},{default:u(()=>[o(W,{class:"absolute w-full h-full"}),o(G,{class:"h-8 w-8",style:we({transform:`rotate(${e(j)}deg)`})},null,8,["style"])]),_:1})],512),f("div",{ref_key:"searchButtonRef",ref:C,class:"relative"},[o(M,{name:"fade",appear:""},{default:u(()=>[e(p)&&!e(a)?(r(),_("div",Fe,Te)):h("",!0)]),_:1}),o(L,{onClick:z,class:ge(["bg-cyan-100 p-11",{"border-[3px] border-yellow-100 p-9 bg-gradient-to-b from-sky-900 bg-transparent":e(c)||e(a),"bg-cyan-100":!e(c)&&!e(a)}]),format:"circle",shadowed:""},{default:u(()=>[e(c)||e(a)?(r(),T(J,{key:0,class:"h-12 w-12"})):(r(),T(K,{key:1,class:"h-8 w-8"}))]),_:1},8,["class"])],512),f("div",{ref_key:"menuButtonRef",ref:R},[o(L,{onClick:U,class:"bg-yellow-200 h-16 w-16 flex justify-center items-center",format:"circle",shadowed:""},{default:u(()=>[o(O,{class:"h-8 w-8"})]),_:1})],512)]),_:1},512)]),e(x)?(r(),_("div",Ee,[o(Y,{onClose:H})])):h("",!0)],64)}}},_t=ie(Ve,[["__scopeId","data-v-66640ac4"]]);export{_t as default};

import Z from"./LocationFound.f60f6b16.js";import ee from"./Logo.38785ac3.js";import te from"./Radar.1346d604.js";import oe from"./CompassCardinalPoints.a1e05d7d.js";import ae from"./Compass.4283665b.js";import se from"./Button.6a8a0819.js";import ne from"./Intersect.4699e07b.js";import le from"./Search.99af4aa0.js";import ce from"./Menu.eda271e9.js";import re from"./NavigationBar.82ad8bc7.js";import ie from"./Menu.a7bedfba.js";import{k as ue,bI as me,c5 as de,bE as _e,bo as fe,r as s,i as pe,b as ve,m as he,l as d,h as o,w as u,bH as B,f as _,u as t,j as p,bD as ye,b$ as we,o as i,bl as ge,bk as be,c as P,bR as Ce,bS as ke,bJ as L}from"./entry.8c32d679.js";import{q as xe}from"./query.7752cd5a.js";import{u as Re}from"./map.e70b2950.js";import{P as Be,L as q}from"./permission.dd244a3c.js";import{u as Le}from"./locations.21a19dc5.js";import{g as Ie}from"./index.4db78ffb.js";import{a as $e}from"./index.9456517d.js";import"./Diamond.488a1fb3.js";import"./BlurredCircle.4c2ed6b4.js";import"./tw-merge.1166cefb.js";import"./nuxt-link.8c50d129.js";import"./SectionHeading.f020760d.js";import"./Cross.fd170940.js";import"./utils.d4d61a44.js";import"./preview.a2eb4179.js";const T=v=>(Ce("data-v-b49136c4"),v=v(),ke(),v),Se={key:0},Me={class:"relative"},Pe={key:0,class:"fixed h-full w-full top-0 left-0 radar-background"},qe=T(()=>_("div",{class:"fixed w-full top-0 h-[20vh] bg-gradient-to-b from-sky-900 to-70%"},null,-1)),Te={key:0,class:"fixed left-0 top-0 translate-y-[-180%] container text-center"},Fe=T(()=>_("div",{class:"text-md text-yellow-200"}," ¡Vaya! Parece que aquí no hay nada ",-1)),Ne=[Fe],Ve={key:0},je={__name:"map",async setup(v){let h,I;const $=me(),{data:F}=([h,I]=de(()=>we("locations",()=>xe("location").find(),{transform:e=>Object.keys(e).map(c=>e[c])})),h=await h,I(),h),n=Re(),N=_e(),S=fe();s(null);const y=s(null),m=s(null),b=s(null),w=s(null),C=s(null),l=s(),g=s(!1),a=s(),f=s(),M=s(),V=s(0),k=s(!1),{width:x,height:ze}=$e(),j=e=>new Promise(function(c){setTimeout(()=>c(),e)}),z=()=>{const e=w.value.getBoundingClientRect(),c=e.top+e.height/2;e.left+e.width/2;const r=y.value.getBoundingClientRect();y.value.style.top=`${c-r.height/2}px`},E=e=>{k.value||(k.value=!0,n.value.toggleCenitalView({onComplete:()=>{k.value=!1}}))},U=async()=>{const e=Ie.timeline();M.value=await Be.requestLocation(),M.value?(l.value=!0,e.add("start").to(b.value,{x:-x.value},"start").to(C.value,{x:x.value},"start"),Promise.all([q.getCurrentLocation(),j(4e3)]).then(([c])=>{if(a.value=F.value.find(r=>q.nearbyLocation(c,r.place.coordinate)),l.value=!1,f.value=!0,a.value?(m.value.show({expanded:!1}),e.to(w.value,{y:x.value*.5})):e.add("start").to(b.value,{x:0},"start").to(C.value,{x:0},"start"),a.value){const r=Le();r.value.includes(a.value._id)||r.value.push(a.value._id),setTimeout(()=>{S.push({path:`${a.value._path}/model`})},5e3)}else setTimeout(()=>{f.value=!1},2e3)})):S.push({path:"/permissions"})},A=e=>{n.value.hide(),m.value.hide(),g.value=!0},D=e=>{setTimeout(()=>{n.value.show()},300),m.value.show({expanded:!0,onComplete:()=>{g.value=!1}})};return pe(()=>{w.value&&y.value&&z(),g.value||l.value||f.value?$.value=L.sky[900]:$.value=N.value?L.teal[700]:L.teal[500]}),ve(()=>{m.value&&m.value.show({expanded:!0}),n.value&&(n.value.show(),n.value.showLocations())}),he(()=>{n.value&&n.value.hideLocations()}),(e,c)=>{const r=Z,H=ee,W=te,J=oe,O=ae,R=se,X=ne,G=le,K=ce,Q=re,Y=ie;return i(),d(ye,null,[o(B,{name:"fade",appear:""},{default:u(()=>[t(a)?(i(),d("div",Se,[o(r,{location:t(a)},null,8,["location"])])):p("",!0)]),_:1}),_("div",Me,[o(H,{"enable-night-mode-change":""}),o(B,{name:"fade",appear:""},{default:u(()=>[t(l)||t(f)&&!t(a)?(i(),d("div",Pe)):p("",!0)]),_:1}),t(l)?(i(),d("div",{key:0,ref_key:"radarRef",ref:y,class:"fixed top-0 left-0 w-screen h-screen"},[o(W),qe],512)):p("",!0),o(Q,{ref_key:"navRef",ref:m,"inital-state":"hide",centered:""},{default:u(()=>[_("div",{ref_key:"compassButtonRef",ref:b},[o(R,{onClick:E,class:"bg-yellow-200 h-16 w-16 relative flex justify-center items-center",format:"circle",shadowed:""},{default:u(()=>[o(J,{class:"absolute w-full h-full"}),o(O,{class:"h-8 w-8",style:ge({transform:`rotate(${t(V)}deg)`})},null,8,["style"])]),_:1})],512),_("div",{ref_key:"searchButtonRef",ref:w,class:"relative"},[o(B,{name:"fade",appear:""},{default:u(()=>[t(f)&&!t(a)?(i(),d("div",Te,Ne)):p("",!0)]),_:1}),o(R,{onClick:U,class:be(["bg-cyan-100 p-11",{"border-[3px] border-yellow-100 p-9 bg-gradient-to-b from-sky-900 bg-transparent":t(l)||t(a),"bg-cyan-100":!t(l)&&!t(a)}]),format:"circle",shadowed:""},{default:u(()=>[t(l)||t(a)?(i(),P(X,{key:0,class:"h-12 w-12"})):(i(),P(G,{key:1,class:"h-8 w-8"}))]),_:1},8,["class"])],512),_("div",{ref_key:"menuButtonRef",ref:C},[o(R,{onClick:A,class:"bg-yellow-200 h-16 w-16 flex justify-center items-center",format:"circle",shadowed:""},{default:u(()=>[o(K,{class:"h-8 w-8"})]),_:1})],512)]),_:1},512)]),t(g)?(i(),d("div",Ve,[o(Y,{onClose:D})])):p("",!0)],64)}}},dt=ue(je,[["__scopeId","data-v-b49136c4"]]);export{dt as default};

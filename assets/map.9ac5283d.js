import Q from"./LocationFound.2bc6341a.js";import Y from"./Logo.ca3e2851.js";import ee from"./Radar.f11866fa.js";import te from"./CompassCardinalPoints.e1932b88.js";import oe from"./Compass.a4a5a3be.js";import ae from"./Button.26a4201a.js";import se from"./Intersect.1bea7a26.js";import ne from"./Search.1eb24d67.js";import le from"./Menu.f021f56f.js";import ce from"./NavigationBar.702ed478.js";import re from"./Menu.7d406a55.js";import{k as ie,bI as ue,c3 as me,p as de,y as fe,r as s,j as _e,g as pe,m as ve,c as d,b as o,w as i,bE as B,a as f,u as e,q as p,F as he,bZ as ye,o as r,x as we,n as ge,i as q,bG as xe,bH as Ce,bJ as L}from"./entry.895585a5.js";import{q as ke}from"./query.1c8cd6b2.js";import{u as be}from"./map.15cd1174.js";import{d as Re}from"./timer.1612f152.js";import{P as Be,L as F}from"./permission.6b6370dd.js";import{u as Le}from"./locations.33d1f01d.js";import{g as Ie}from"./index.4db78ffb.js";import{a as $e}from"./index.5a96cef1.js";import"./Diamond.981ce057.js";import"./BlurredCircle.8f0cf029.js";import"./tw-merge.1166cefb.js";import"./nuxt-link.740593d0.js";import"./SectionHeading.d3a979a7.js";import"./Cross.c1790ab2.js";import"./utils.bed1adf5.js";import"./preview.e97954c0.js";const P=v=>(xe("data-v-eb37cf01"),v=v(),Ce(),v),Me={key:0},Se={class:"relative"},qe={key:0,class:"fixed h-full w-full top-0 left-0 radar-background"},Fe=P(()=>f("div",{class:"fixed w-full top-0 h-[20vh] bg-gradient-to-b from-sky-900 to-70%"},null,-1)),Pe={key:0,class:"fixed left-0 top-0 translate-y-[-180%] container text-center"},Ne=P(()=>f("div",{class:"text-md text-yellow-200"}," ¡Vaya! Parece que aquí no hay nada ",-1)),Te=[Ne],Ve={key:0},je={__name:"map",async setup(v){let h,I;const $=ue(),{data:N}=([h,I]=me(()=>ye("locations",()=>ke("location").find(),{transform:t=>Object.keys(t).map(m=>t[m])})),h=await h,I(),h),n=be(),T=de(),M=fe();s(null);const y=s(null),u=s(null),x=s(null),w=s(null),C=s(null),l=s(),g=s(!1),a=s(),_=s(),S=s(),V=s(0),k=s(!1),{width:b,height:ze}=$e(),j=()=>{const t=w.value.getBoundingClientRect(),m=t.top+t.height/2;t.left+t.width/2;const c=y.value.getBoundingClientRect();y.value.style.top=`${m-c.height/2}px`},z=t=>{k.value||(k.value=!0,n.value.toggleCenitalView({onComplete:()=>{k.value=!1}}))},E=async()=>{const t=Ie.timeline();S.value=await Be.requestLocation(),S.value?(l.value=!0,t.add("start").to(x.value,{x:-b.value},"start").to(C.value,{x:b.value},"start"),Promise.all([F.getCurrentLocation(),Re(4e3)]).then(([m])=>{if(a.value=N.value.find(c=>F.nearbyLocation(m,c.place.coordinate)),l.value=!1,_.value=!0,a.value?(u.value.show({expanded:!1}),t.to(w.value,{y:b.value*.5})):t.add("start").to(x.value,{x:0},"start").to(C.value,{x:0},"start"),a.value){const c=Le();c.value.includes(a.value._id)||c.value.push(a.value._id),setTimeout(()=>{M.push({path:`${a.value._path}/model`})},5e3)}else setTimeout(()=>{_.value=!1},2e3)})):M.push({path:"/permissions"})},U=t=>{n.value.hide(),u.value.hide(),g.value=!0},A=t=>{setTimeout(()=>{n.value.show()},300),u.value.show({expanded:!0,onComplete:()=>{g.value=!1}})};return _e(()=>{w.value&&y.value&&j(),g.value||l.value||_.value?$.value=L.sky[900]:$.value=T.value?L.teal[700]:L.teal[500]}),pe(()=>{u.value&&u.value.show({expanded:!0}),n.value&&(n.value.show(),n.value.showLocations())}),ve(()=>{n.value&&n.value.hideLocations()}),(t,m)=>{const c=Q,H=Y,W=ee,D=te,G=oe,R=ae,J=se,O=ne,X=le,Z=ce,K=re;return r(),d(he,null,[o(B,{name:"fade",appear:""},{default:i(()=>[e(a)?(r(),d("div",Me,[o(c,{location:e(a)},null,8,["location"])])):p("",!0)]),_:1}),f("div",Se,[o(H,{"enable-night-mode-change":""}),o(B,{name:"fade",appear:""},{default:i(()=>[e(l)||e(_)&&!e(a)?(r(),d("div",qe)):p("",!0)]),_:1}),e(l)?(r(),d("div",{key:0,ref_key:"radarRef",ref:y,class:"fixed top-0 left-0 w-screen h-screen"},[o(W),Fe],512)):p("",!0),o(Z,{ref_key:"navRef",ref:u,"inital-state":"hide",centered:""},{default:i(()=>[f("div",{ref_key:"compassButtonRef",ref:x},[o(R,{onClick:z,class:"bg-yellow-200 h-16 w-16 relative flex justify-center items-center",format:"circle",shadowed:""},{default:i(()=>[o(D,{class:"absolute w-full h-full"}),o(G,{class:"h-8 w-8",style:we({transform:`rotate(${e(V)}deg)`})},null,8,["style"])]),_:1})],512),f("div",{ref_key:"searchButtonRef",ref:w,class:"relative"},[o(B,{name:"fade",appear:""},{default:i(()=>[e(_)&&!e(a)?(r(),d("div",Pe,Te)):p("",!0)]),_:1}),o(R,{onClick:E,class:ge(["bg-cyan-100 p-11",{"border-[3px] border-yellow-100 p-9 bg-gradient-to-b from-sky-900 bg-transparent":e(l)||e(a),"bg-cyan-100":!e(l)&&!e(a)}]),format:"circle",shadowed:""},{default:i(()=>[e(l)||e(a)?(r(),q(J,{key:0,class:"h-12 w-12"})):(r(),q(O,{key:1,class:"h-8 w-8"}))]),_:1},8,["class"])],512),f("div",{ref_key:"menuButtonRef",ref:C},[o(R,{onClick:U,class:"bg-yellow-200 h-16 w-16 flex justify-center items-center",format:"circle",shadowed:""},{default:i(()=>[o(X,{class:"h-8 w-8"})]),_:1})],512)]),_:1},512)]),e(g)?(r(),d("div",Ve,[o(K,{onClose:A})])):p("",!0)],64)}}},ft=ie(je,[["__scopeId","data-v-eb37cf01"]]);export{ft as default};
